<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>where is NJ Transit?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://unpkg.com/maplibre-gl/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/pmtiles@latest/dist/pmtiles.js"></script>
    <script src="https://unpkg.com/@protomaps/basemaps@5/dist/basemaps.js" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>

    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/ui.css">
</head>

<body>
    <div class="overlay" id="welcomeOverlay">
        <div class="welcome" id="welcomeScreen">
            <h1>where is NJ Transit?</h1>
            <h3>This is a live interactive map that allows you to see the various stations and active trains on NJ
                Transit.
                Click on a station for departures or use the sidebar to find one by search. You can also toggle lines
                based
                on your preference.</h3>

            <h3 style="color: red;">NOTE: While the data updates every minute, there is a chance it is inaccurate or
                outdated. For official timings, always use the official NJ Transit app or website.</h3>

            <button class="welcome_button" onclick="welcome_button()" id="welcomeButton">
                <span>Enter</span>
            </button>
        </div>
    </div>

    <div class="station_status" id="stationStatus">
        <img src="assets/service/draggable.svg" alt="Use to Drag the Departure List" class="draggable_station_status">

        <h1 id="stationStatusName">Current Station</h1>

        <div class="station_routes" id="stationRoutes">
            <h3 id="NoCurrentDepartures" style="display: none;">No current departures. Contact me on GitHub if you think
                this is a mistake.</h3>
            <div class="station_route" id="default" style="display: none;">
                <div class="station_route_header">
                    <img src="assets/lines/northeastcorridor.svg" alt="Train Route Icon">
                    <div class="station_route_inner" id="station_route_inner">
                        <div id="station_route_inner1" class="station_route_inner1">
                            <h1>New York -SEC</h1>
                            <h3>NEC Train 6767</h3>
                        </div>

                        <div id="station_route_inner2" class="station_route_inner2">
                            <h1>2:39 PM @ Track 1</h1>
                            <h3>Status: Delayed 2m</h3>
                        </div>
                    </div>
                </div>
                <div class="station_info">
                    <div class="station_col" id="stationCol">
                        <h3>Station</h3>
                        <br>
                        <h4>Trenton</h4>
                    </div>
                    <div class="scheduled_col" id="scheduledCol">
                        <h3>Scheduled</h3>
                        <br>
                        <h4>4:30 PM</h4>
                    </div>
                    <div class="status_col" id="statusCol">
                        <h3>Status</h3>
                        <br>
                        <h4>Delayed 1m</h4>
                    </div>
                </div>
            </div>
        </div>
        <br>

        <button class="station_close" onclick="station_close()" id="stationClose">
            <span>Close</span>
        </button>
    </div>

    <div class="about" id="aboutScreen">
        <h1>About</h1>

        <div class="about_elements">
            <div class="about_element">
                <div class="about_title">
                    <h3>Is this official?</h3>
                </div>
                <div class="about_panel">
                    <p>No, this is not an official NJ Transit application, just a side project I did for fun. For
                        official information, please use the NJ
                        Transit <a href="https://www.njtransit.com/app" target="_blank">app</a> or <a
                            href="https://www.njtransit.com/" target="_blank">website</a>.</p>
                </div>
            </div>
            <div class="about_element">
                <div class="about_title">
                    <h3>How accurate is the data?</h3>
                </div>
                <div class="about_panel">
                    <p>The status of the current trains operating is updated every minute, while track information and
                        announcements are updated per hour. Data is sourced from the NJ Transit API.</p>
                </div>
            </div>
            <div class="about_element">
                <div class="about_title">
                    <h3>How is the train data collected and updated?</h3>
                </div>
                <div class="about_panel">
                    <p>At around 2:00 AM, I retrieve the daily schedule from NJ Transit's API and store it in my
                        database. This gives me the schedule for the entire day and up to 3:00 AM the next day. I also
                        update a seperate database every minute, with each train currently moving along with its
                        coordinates and any possible delay. I combine this data to display both live trains and station
                        schedules as accurately as possible.</p>
                </div>
            </div>
            <div class="about_element">
                <div class="about_title">
                    <h3>Something is inaccurate...</h3>
                </div>
                <div class="about_panel">
                    <p>Please make an issue on GitHub (link in the sidebar) so I can look and find the issue. Include as
                        much information as you can as unfortunately recreating the problem is not easy as the data is
                        constantly changing.</p>
                </div>
            </div>
            <div class="about_element">
                <div class="about_title">
                    <h3>WHY IS NJ TRANSIT ALWAYS LATE?</h3>
                </div>
                <div class="about_panel">
                    <p>I DONT KNOW</p>
                </div>
            </div>
        </div>

        <button class="about_button" onclick="about_button()" id="aboutButton">
            <span>Close</span>
        </button>
    </div>

    <div class="settings" id="settingsScreen">
        <h1>Settings</h1>

        <div class="settings-list" id="settingsList">
            <div class="setting-item">
                <span class="setting-name">Dark Mode</span>
                <label class="switch">
                    <input type="checkbox" id="darkToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span class="setting-name">Use 24-Hour Clock</span>
                <label class="switch">
                    <input type="checkbox" id="timeToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <span id="timeDisplay" class="time_display">Current Time: 10:33 AM</span>
            <div class="setting-item">
                <span class="setting-name">Use Local Timezone</span>
                <label class="switch">
                    <input type="checkbox" id="timezoneToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <span id="timezoneDisplay" class="time_display">Current Timezone: America/New_York</span>
            <div class="setting-item">
                <span class="setting-name">Hide All Stations</span>
                <label class="switch">
                    <input type="checkbox" id="stationsToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span class="setting-name">Hide All Tracks</span>
                <label class="switch">
                    <input type="checkbox" id="tracksToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span class="setting-name">Hide All Trains</span>
                <label class="switch">
                    <input type="checkbox" id="trainsToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <br>

        <button class="settings_button" onclick="settings_button()" id="settingsButton">
            <span>Close</span>
        </button>
    </div>

    <div class="sidebar" style="display: none;" id="mainSidebar">
        <h1>Rail Routes</h1>
        <h4>Click on a route to hide it</h4>

        <div class="sidebar_search" id="sidebarSearch">
            <input type="text" id="stationSearch" placeholder="Enter Station Name" autocomplete="off" />
            <div class="search_results" id="searchResults">
                <h3 id="ResultOne">Station Name</h3>
                <h3 id="ResultTwo">Station Name</h3>
                <h3 id="ResultThree">Station Name</h3>
            </div>
        </div>
        <br>

        <div class="sidebar_routes">
            <button class="sidebar_route_button" id="northeastcorridortrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/northeastcorridor.svg" alt="Northeast Corridor Icon">
                <span>Northeast Corridor</span>
            </button>
            <button class="sidebar_route_button" id="morristowntrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/morristown.svg" alt="Morristown Line Icon">
                <span>Morristown Line</span>
            </button>
            <button class="sidebar_route_button" id="gladstonetrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/gladstone.svg" alt="Gladstone Branch Icon">
                <span>Gladstone Branch</span>
            </button>
            <button class="sidebar_route_button" id="northjerseycoasttrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/northjerseycoast.svg" alt="North Jersey Coast Icon">
                <span>North Jersey Coast</span>
            </button>
            <button class="sidebar_route_button" id="maintrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/mainbergen.svg" alt="Main/Bergen Line Icon">
                <span>Main/Bergen Line</span>
            </button>
            <button class="sidebar_route_button" id="montclairboontontrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/montclairboonton.svg" alt="Montclair-Boonton Icon">
                <span>Montclair-Boonton</span>
            </button>
            <button class="sidebar_route_button" id="raritanvalleytrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/raritanvalley.svg" alt="Raritan Valley Icon">
                <span>Raritan Valley</span>
            </button>
            <button class="sidebar_route_button" id="pascackvalleytrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/pascackvalley.svg" alt="Pascack Valley Icon">
                <span>Pascack Valley</span>
            </button>
            <button class="sidebar_route_button" id="atlanticcitytrack" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/atlanticcity.svg" alt="Atlantic City Line Icon">
                <span>Atlantic City Line</span>
            </button>
            <button class="sidebar_route_button" id="meadowlands" onclick="toggleLayerVisibility(this.id)">
                <img src="assets/lines/meadowlands.svg" alt="Meadowlands Rail Line Icon">
                <span>Meadowlands Rail Line</span>
            </button>
        </div>
        <br>
        <div class="sidebar_about">
            <button onclick="about_button()">About</button>
            <button onclick="settings_button()">Settings</button>
        </div>
        <br>
        <div class="links">
            <a href="https://github.com/chexedy/whereisnjtransit" target="_blank"><img
                    src="./assets/links/github-mark.svg" alt="GitHub Logo"></a>
            <a href="https://www.linkedin.com/in/ayaan7m/" target="_blank"><img src="assets/links/linkedin.svg"
                    alt="LinkedIn Logo"></a>
        </div>
    </div>

    <div class="sidebar_opener">
        <button class="sidebar_button" onclick="sidebar_open()">â˜°</button>
    </div>

    <div class="location" id="userLocation">
        <button class="location_button" id="locationButton">
            <img src="assets/service/location.svg" alt="Location Icon">
        </button>
    </div>

    <div id="map"></div>
    <script src="js/map.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/transit.js"></script>
</body>

</html>